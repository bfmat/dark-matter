Using TensorFlow backend.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
batch_normalization_1 (Batch (None, 255)               1020      
_________________________________________________________________
dense_1 (Dense)              (None, 100)               25600     
_________________________________________________________________
dense_2 (Dense)              (None, 40)                4040      
_________________________________________________________________
dense_3 (Dense)              (None, 10)                410       
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 11        
=================================================================
Total params: 31,081
Trainable params: 30,571
Non-trainable params: 510
_________________________________________________________________
None
Train on 16000 samples, validate on 4000 samples
Epoch 1/100
2018-08-23 10:15:11.577430: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-08-23 10:15:11.775771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1392] Found device 0 with properties: 
name: GeForce GTX 1060 6GB major: 6 minor: 1 memoryClockRate(GHz): 1.759
pciBusID: 0000:03:00.0
totalMemory: 5.93GiB freeMemory: 5.65GiB
2018-08-23 10:15:11.775817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0
2018-08-23 10:15:12.091119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-23 10:15:12.091170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0 
2018-08-23 10:15:12.091180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N 
2018-08-23 10:15:12.091399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 5429 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 6GB, pci bus id: 0000:03:00.0, compute capability: 6.1)
16000/16000 [==============================] - 4s 273us/step - loss: 0.0776 - acc: 0.9056 - val_loss: 0.0546 - val_acc: 0.9267
Epoch 2/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0545 - acc: 0.9310 - val_loss: 0.0564 - val_acc: 0.9427
Epoch 3/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0476 - acc: 0.9420 - val_loss: 0.0873 - val_acc: 0.9250
Epoch 4/100
16000/16000 [==============================] - 3s 211us/step - loss: 0.0473 - acc: 0.9419 - val_loss: 0.0457 - val_acc: 0.9453
Epoch 5/100
16000/16000 [==============================] - 3s 209us/step - loss: 0.0414 - acc: 0.9480 - val_loss: 0.0536 - val_acc: 0.9445
Epoch 6/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0396 - acc: 0.9497 - val_loss: 0.0448 - val_acc: 0.9480
Epoch 7/100
16000/16000 [==============================] - 3s 211us/step - loss: 0.0363 - acc: 0.9549 - val_loss: 0.0407 - val_acc: 0.9505
Epoch 8/100
16000/16000 [==============================] - 3s 208us/step - loss: 0.0353 - acc: 0.9547 - val_loss: 0.0464 - val_acc: 0.9455
Epoch 9/100
16000/16000 [==============================] - 3s 208us/step - loss: 0.0309 - acc: 0.9614 - val_loss: 0.0394 - val_acc: 0.9553
Epoch 10/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0290 - acc: 0.9628 - val_loss: 0.0374 - val_acc: 0.9545
Epoch 11/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0318 - acc: 0.9596 - val_loss: 0.0357 - val_acc: 0.9530
Epoch 12/100
16000/16000 [==============================] - 3s 208us/step - loss: 0.0274 - acc: 0.9640 - val_loss: 0.0421 - val_acc: 0.9497
Epoch 13/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0262 - acc: 0.9657 - val_loss: 0.0381 - val_acc: 0.9533
Epoch 14/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0242 - acc: 0.9682 - val_loss: 0.0386 - val_acc: 0.9535
Epoch 15/100
16000/16000 [==============================] - 3s 197us/step - loss: 0.0244 - acc: 0.9683 - val_loss: 0.0435 - val_acc: 0.9497
Epoch 16/100
16000/16000 [==============================] - 3s 197us/step - loss: 0.0220 - acc: 0.9709 - val_loss: 0.0427 - val_acc: 0.9500
Epoch 17/100
16000/16000 [==============================] - 3s 196us/step - loss: 0.0192 - acc: 0.9754 - val_loss: 0.0394 - val_acc: 0.9540
Epoch 18/100
16000/16000 [==============================] - 3s 201us/step - loss: 0.0203 - acc: 0.9736 - val_loss: 0.0387 - val_acc: 0.9527
Epoch 19/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0191 - acc: 0.9764 - val_loss: 0.0456 - val_acc: 0.9450
Epoch 20/100
16000/16000 [==============================] - 3s 200us/step - loss: 0.0188 - acc: 0.9766 - val_loss: 0.0484 - val_acc: 0.9417
Epoch 21/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0208 - acc: 0.9737 - val_loss: 0.0400 - val_acc: 0.9503
Epoch 22/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0193 - acc: 0.9750 - val_loss: 0.0471 - val_acc: 0.9415
Epoch 23/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0188 - acc: 0.9762 - val_loss: 0.0458 - val_acc: 0.9455
Epoch 24/100
16000/16000 [==============================] - 3s 211us/step - loss: 0.0174 - acc: 0.9783 - val_loss: 0.0416 - val_acc: 0.9475
Epoch 25/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0170 - acc: 0.9782 - val_loss: 0.0421 - val_acc: 0.9470
Epoch 26/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0162 - acc: 0.9795 - val_loss: 0.0444 - val_acc: 0.9460
Epoch 27/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0160 - acc: 0.9794 - val_loss: 0.0588 - val_acc: 0.9290
Epoch 28/100
16000/16000 [==============================] - 3s 201us/step - loss: 0.0148 - acc: 0.9812 - val_loss: 0.0410 - val_acc: 0.9477
Epoch 29/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0180 - acc: 0.9768 - val_loss: 0.0403 - val_acc: 0.9503
Epoch 30/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0142 - acc: 0.9812 - val_loss: 0.0474 - val_acc: 0.9443
Epoch 31/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0163 - acc: 0.9795 - val_loss: 0.0511 - val_acc: 0.9397
Epoch 32/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0154 - acc: 0.9794 - val_loss: 0.0426 - val_acc: 0.9480
Epoch 33/100
16000/16000 [==============================] - 3s 208us/step - loss: 0.0161 - acc: 0.9803 - val_loss: 0.0447 - val_acc: 0.9455
Epoch 34/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0139 - acc: 0.9829 - val_loss: 0.0471 - val_acc: 0.9470
Epoch 35/100
16000/16000 [==============================] - 3s 201us/step - loss: 0.0137 - acc: 0.9828 - val_loss: 0.0434 - val_acc: 0.9480
Epoch 36/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0139 - acc: 0.9821 - val_loss: 0.0440 - val_acc: 0.9485
Epoch 37/100
16000/16000 [==============================] - 3s 211us/step - loss: 0.0200 - acc: 0.9764 - val_loss: 0.0434 - val_acc: 0.9470
Epoch 38/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0146 - acc: 0.9821 - val_loss: 0.0490 - val_acc: 0.9420
Epoch 39/100
16000/16000 [==============================] - 3s 201us/step - loss: 0.0118 - acc: 0.9852 - val_loss: 0.0421 - val_acc: 0.9495
Epoch 40/100
16000/16000 [==============================] - 3s 200us/step - loss: 0.0134 - acc: 0.9834 - val_loss: 0.0439 - val_acc: 0.9463
Epoch 41/100
16000/16000 [==============================] - 3s 202us/step - loss: 0.0123 - acc: 0.9844 - val_loss: 0.0455 - val_acc: 0.9455
Epoch 42/100
16000/16000 [==============================] - 3s 208us/step - loss: 0.0125 - acc: 0.9840 - val_loss: 0.0446 - val_acc: 0.9480
Epoch 43/100
16000/16000 [==============================] - 3s 199us/step - loss: 0.0122 - acc: 0.9847 - val_loss: 0.0420 - val_acc: 0.9493
Epoch 44/100
16000/16000 [==============================] - 3s 199us/step - loss: 0.0120 - acc: 0.9842 - val_loss: 0.0461 - val_acc: 0.9443
Epoch 45/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0147 - acc: 0.9817 - val_loss: 0.0470 - val_acc: 0.9453
Epoch 46/100
16000/16000 [==============================] - 3s 199us/step - loss: 0.0109 - acc: 0.9861 - val_loss: 0.0488 - val_acc: 0.9435
Epoch 47/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0122 - acc: 0.9841 - val_loss: 0.0471 - val_acc: 0.9417
Epoch 48/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0107 - acc: 0.9862 - val_loss: 0.0453 - val_acc: 0.9457
Epoch 49/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0114 - acc: 0.9851 - val_loss: 0.0438 - val_acc: 0.9443
Epoch 50/100
16000/16000 [==============================] - 3s 195us/step - loss: 0.0111 - acc: 0.9859 - val_loss: 0.0448 - val_acc: 0.9433
Epoch 51/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0131 - acc: 0.9829 - val_loss: 0.0568 - val_acc: 0.9327
Epoch 52/100
16000/16000 [==============================] - 3s 199us/step - loss: 0.0119 - acc: 0.9851 - val_loss: 0.0430 - val_acc: 0.9500
Epoch 53/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0102 - acc: 0.9869 - val_loss: 0.0431 - val_acc: 0.9495
Epoch 54/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0114 - acc: 0.9855 - val_loss: 0.0464 - val_acc: 0.9455
Epoch 55/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0101 - acc: 0.9869 - val_loss: 0.0450 - val_acc: 0.9467
Epoch 56/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0104 - acc: 0.9875 - val_loss: 0.0551 - val_acc: 0.9367
Epoch 57/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0150 - acc: 0.9807 - val_loss: 0.0724 - val_acc: 0.9165
Epoch 58/100
16000/16000 [==============================] - 3s 201us/step - loss: 0.0137 - acc: 0.9834 - val_loss: 0.0445 - val_acc: 0.9467
Epoch 59/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0126 - acc: 0.9841 - val_loss: 0.0467 - val_acc: 0.9457
Epoch 60/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0083 - acc: 0.9901 - val_loss: 0.0453 - val_acc: 0.9470
Epoch 61/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0103 - acc: 0.9872 - val_loss: 0.0464 - val_acc: 0.9445
Epoch 62/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0093 - acc: 0.9884 - val_loss: 0.0428 - val_acc: 0.9505
Epoch 63/100
16000/16000 [==============================] - 3s 195us/step - loss: 0.0116 - acc: 0.9858 - val_loss: 0.0436 - val_acc: 0.9457
Epoch 64/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0109 - acc: 0.9861 - val_loss: 0.0449 - val_acc: 0.9450
Epoch 65/100
16000/16000 [==============================] - 3s 202us/step - loss: 0.0118 - acc: 0.9851 - val_loss: 0.0513 - val_acc: 0.9397
Epoch 66/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0112 - acc: 0.9849 - val_loss: 0.0428 - val_acc: 0.9495
Epoch 67/100
16000/16000 [==============================] - 3s 208us/step - loss: 0.0110 - acc: 0.9862 - val_loss: 0.0467 - val_acc: 0.9427
Epoch 68/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0100 - acc: 0.9872 - val_loss: 0.0507 - val_acc: 0.9387
Epoch 69/100
16000/16000 [==============================] - 3s 209us/step - loss: 0.0091 - acc: 0.9888 - val_loss: 0.0495 - val_acc: 0.9423
Epoch 70/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0088 - acc: 0.9892 - val_loss: 0.0499 - val_acc: 0.9425
Epoch 71/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0089 - acc: 0.9887 - val_loss: 0.0441 - val_acc: 0.9453
Epoch 72/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0099 - acc: 0.9876 - val_loss: 0.0409 - val_acc: 0.9520
Epoch 73/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0095 - acc: 0.9882 - val_loss: 0.0420 - val_acc: 0.9510
Epoch 74/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0092 - acc: 0.9882 - val_loss: 0.0449 - val_acc: 0.9443
Epoch 75/100
16000/16000 [==============================] - 3s 210us/step - loss: 0.0115 - acc: 0.9856 - val_loss: 0.0439 - val_acc: 0.9480
Epoch 76/100
16000/16000 [==============================] - 3s 210us/step - loss: 0.0082 - acc: 0.9894 - val_loss: 0.0454 - val_acc: 0.9475
Epoch 77/100
16000/16000 [==============================] - 3s 207us/step - loss: 0.0096 - acc: 0.9882 - val_loss: 0.0546 - val_acc: 0.9405
Epoch 78/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0093 - acc: 0.9879 - val_loss: 0.0433 - val_acc: 0.9503
Epoch 79/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0098 - acc: 0.9877 - val_loss: 0.0454 - val_acc: 0.9473
Epoch 80/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0114 - acc: 0.9855 - val_loss: 0.0472 - val_acc: 0.9433
Epoch 81/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0100 - acc: 0.9876 - val_loss: 0.0416 - val_acc: 0.9480
Epoch 82/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0087 - acc: 0.9890 - val_loss: 0.0424 - val_acc: 0.9500
Epoch 83/100
16000/16000 [==============================] - 3s 199us/step - loss: 0.0088 - acc: 0.9881 - val_loss: 0.0392 - val_acc: 0.9533
Epoch 84/100
16000/16000 [==============================] - 3s 203us/step - loss: 0.0089 - acc: 0.9886 - val_loss: 0.0418 - val_acc: 0.9505
Epoch 85/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0091 - acc: 0.9882 - val_loss: 0.0497 - val_acc: 0.9425
Epoch 86/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0075 - acc: 0.9911 - val_loss: 0.0447 - val_acc: 0.9487
Epoch 87/100
16000/16000 [==============================] - 3s 206us/step - loss: 0.0098 - acc: 0.9871 - val_loss: 0.0420 - val_acc: 0.9495
Epoch 88/100
16000/16000 [==============================] - 3s 198us/step - loss: 0.0080 - acc: 0.9898 - val_loss: 0.0413 - val_acc: 0.9520
Epoch 89/100
16000/16000 [==============================] - 3s 201us/step - loss: 0.0086 - acc: 0.9891 - val_loss: 0.0435 - val_acc: 0.9520
Epoch 90/100
16000/16000 [==============================] - 3s 198us/step - loss: 0.0084 - acc: 0.9897 - val_loss: 0.0430 - val_acc: 0.9495
Epoch 91/100
16000/16000 [==============================] - 3s 204us/step - loss: 0.0100 - acc: 0.9873 - val_loss: 0.0404 - val_acc: 0.9490
Epoch 92/100
16000/16000 [==============================] - 3s 202us/step - loss: 0.0084 - acc: 0.9902 - val_loss: 0.0431 - val_acc: 0.9483
Epoch 93/100
16000/16000 [==============================] - 3s 195us/step - loss: 0.0098 - acc: 0.9875 - val_loss: 0.0418 - val_acc: 0.9465
Epoch 94/100
16000/16000 [==============================] - 3s 193us/step - loss: 0.0073 - acc: 0.9908 - val_loss: 0.0432 - val_acc: 0.9487
Epoch 95/100
16000/16000 [==============================] - 3s 195us/step - loss: 0.0096 - acc: 0.9883 - val_loss: 0.0480 - val_acc: 0.9437
Epoch 96/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0080 - acc: 0.9895 - val_loss: 0.0452 - val_acc: 0.9463
Epoch 97/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0087 - acc: 0.9884 - val_loss: 0.0436 - val_acc: 0.9505
Epoch 98/100
16000/16000 [==============================] - 3s 196us/step - loss: 0.0070 - acc: 0.9911 - val_loss: 0.0432 - val_acc: 0.9503
Epoch 99/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0078 - acc: 0.9899 - val_loss: 0.0500 - val_acc: 0.9435
Epoch 100/100
16000/16000 [==============================] - 3s 205us/step - loss: 0.0109 - acc: 0.9862 - val_loss: 0.0440 - val_acc: 0.9487
